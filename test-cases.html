<!doctype html>
<!-- - - - - - - - - - - - - - - -->
<!--  dna.js                     -->
<!--  Test Cases                 -->
<!--  dnajs.org/test-cases.html  -->
<!-- - - - - - - - - - - - - - - -->
<html>
<head>
<meta charset=utf-8>
<title>dna.js &bull; Test Cases</title>
<style>
   body            { font-family: sans-serif; margin: 30px; }
   h1, h3          { margin: 0px 0px 5px 0px; }
   h2              { margin: 0px; }
   p               { margin: 0px 0px 3px 0px; }
   button          { cursor: pointer; }
   label           { display: block; }
   #mode           { display: inline-block; width: 75px; }
   .push-right     { float: right; }
   .test-case      { display: inline-block; vertical-align: top; border: 1px solid silver;
                     padding: 10px; margin: 0px 20px 20px 0px; }
   fieldset        { float: left; width: 200px; border: 1px solid silver; padding-bottom: 0px; }
   legend          { border: 1px solid silver; padding: 0px 10px; }
   .dna-template   { display: none; }
   .dna-clone      { background-color: darkseagreen; }
   div.dna-clone   { padding: 10px; margin-bottom: 15px; }
   .dna-clone img  { width: 120px; }
   .color-change   { background-color: lightsteelblue; }
   .color-change2  { background-color: gold; }
   #back,
   #back-expected  { background-color: honeydew; }
   .border-change  { border: 2px solid darkorange; }
   .border-change2 { border: 2px solid darkslateblue; }
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script>
var testing = {
   summary: function() {
      var mode = $('head script[src^=dna]').attr('src');
      $('#mode').text(mode);
      if (mode == 'dna.js')
         $('#switch').attr('href', '?min');
      console.log('');
      dna.info();
      console.log('');
      },
   setup: function() {
      var dna =    '<script src=dna.js>';
      var dnaMin = '<script src=dna.min.js>';
      $('head').append($(location.search == '?min' ? dnaMin : dna ));
      console.log('~~ dna.js Test Cases ~~');
      }
   };
testing.setup();
</script>
</head>
<body>
<div class=push-right>
   <a href="http://dnajs.org/">dnajs.org</a>
</div>
<h1>dna.js Template Cloner</h1>
<h2>Test Cases</h2>
<p><span id=mode></span> &mdash; <a id=switch href="test-cases.html">switch</a></p>
<br>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #01</h3>
   <p>Add 3 items and delete 1 item</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t01-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <span>~~author~~</span></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>The DOM</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Howdy HTML5</span></div>
            <div>Author: <span>Ed</span></div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test01 = {
   run: function() {
      console.log('Test Case: #01');
      var book1 = { title: 'The DOM',      author: 'Jan' };
      var book2 = { title: 'Styling CSS3', author: 'Abby' };
      var book3 = { title: 'Howdy HTML5',  author: 'Ed' };
      dna.clone('t01-book', book1);
      var clone = dna.clone('t01-book', book2);
      dna.clone('t01-book', book3);
      dna.destroy(clone);
      }
   };
$(test01.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #02</h3>
   <p>Add 2 items, empty, and add 1 item (with mustache)</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <hr>
         <div id="t02-book" class="dna-template">
            <div data-class="class">Title: <span>{{title}}</span></div>
            <div data-class=~~sale,wow,color-change~~>
               Author: <span data-class=~~sale,color-change~~>{{author}}</span>
            </div>
         </div>
         <hr>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <hr>
         <div class=dna-clone>
            <div class=color-change>Title: <span class=color-change2>The One</span></div>
            <div class=color-change>Author: <span>Lee</span></div>
         </div>
         <hr>
      </div>
   </fieldset>
</div>
<script>
var test02 = {
   run: function() {
      console.log('Test Case: #02');
      var book1 = { title: 'The DOM',     author: 'Jan' };
      var book2 = { title: 'Howdy HTML5', author: 'Ed' };
      var book3 = { title: 'The One',     author: 'Lee', class: 'color-change', sale: false };
      dna.clone('t02-book', [book1, book2]);
      dna.empty('t02-book');
      var titleElem = dna.clone('t02-book', book1).find('span').first();
      titleElem.addClass('color-change2');
      dna.mutate(titleElem, book3);
      }
   };
$(test02.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #03</h3>
   <p>Add 3 items with fade (1st one blue) and top set to true</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <hr>
         <div id=t03-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <span>~~author~~</span></div>
         </div>
         <hr>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <hr>
         <div class=dna-clone>
            <div>Title:  <span>3rd</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>2nd</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>1<sup>st</sup> &bull;</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <hr>
      </div>
   </fieldset>
</div>
<script>
var test03 = {
   run: function() {
      console.log('Test Case: #03');
      var book1 = { title: '1<sup>st</sup> &bull;', author: 'Jan' };
      var book2 = { title: '2nd', author: 'Jan' };
      var book3 = { title: '3rd', author: 'Jan' };
      var options = { fade: true, top: true, html: true };
      dna.clone('t03-book', book1, options).addClass('color-change');
      dna.clone('t03-book', book2, options);
      dna.clone('t03-book', book3, options);
      }
   };
$(test03.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #04</h3>
   <p>Add 1 items with an image</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t04-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <span>~~author~~</span></div>
            <div>Cover: <img data-attr-src=~~image~~ src="" alt="Cover"></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>&lt;b&gt;Text&lt;/b&gt;&amp;bull;</span></div>
            <div>Author: <span>Lee</span></div>
            <div>Cover: <img src="http://dnajs.org/graphics/dnajs-logo.png" alt="Cover"></div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test04 = {
   run: function() {
      console.log('Test Case: #04');
      var book = {
         title:  '<b>Text</b>&bull;',
         author: 'Lee',
         image:  'http://dnajs.org/graphics/dnajs-logo.png'
         };
      dna.clone('t04-book', book);
      }
   };
$(test04.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #05</h3>
   <p>Add 2 items in an array twice</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t05-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <span>~~author~~</span></div>
         </div>
         <hr>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>1st</span></div>
            <div>Author: <span>Lee</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>2st</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>1st</span></div>
            <div>Author: <span>Lee</span></div>
         </div>
         <div class="dna-clone color-change">
            <div>Title:  <span>2st</span></div>
            <div>Author: <span>Jan</span></div>
         </div>
         <hr>
      </div>
   </fieldset>
</div>
<script>
var test05 = {
   run: function() {
      console.log('Test Case: #05');
      var book1 = { title: '1st', author: 'Lee' };
      var book2 = { title: '2nd', author: 'Jan' };
      dna.clone('t05-book', [book1, book2]).addClass('color-change');
      dna.clone('t05-book', [book1, book2], { empty: true });
      dna.clone('t05-book', [book1, book2]).addClass('color-change');
      }
   };
$(test05.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #06</h3>
   <p>Add 1 item with attributes</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t06-book class=dna-template data-class=~~extra~~>
            <div id=~~info.isbn~~ data-class=~~language,color-change,do-not-apply-this-class~~>
               Title: <span data-lang=~~language~~ lang=~~language~~>~~title~~</span>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class="dna-clone border-change">
            <div id=123-expected class=color-change>
               Title: <span lang=fr class=color-change2>Les Attributs</span>
           </div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test06 = {
   run: function() {
      console.log('Test Case: #06');
      var bouquin = {
         title:    'Les Attributs',
         info:     { isbn: 123 },
         language: 'fr',
         extra:    'border-change'
         };
      dna.clone('t06-book', bouquin);
      $('#123').find('[lang=fr]').addClass('color-change2');
      }
   };
$(test06.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #07</h3>
   <p>Embedded template with array of data</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t07-book class=dna-template>
            <div>Author: <span>~~author.name~~</span></div>
            <div>
               <div id=t07-book-chapter class=dna-template>
                  <div>Chapter: <span>~~header~~</span><span>~~author.name~~</span></div>
               </div>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Author: <span>Ed</span></div>
            <div>
            </div>
         </div>
         <div class=dna-clone>
            <div>Author: <span>Jan</span></div>
            <div>
               <div class="dna-clone color-change">
                  <div>Chapter: <span>Preface</span><span></span></div>
                  <div></div>
               </div>
               <div class="dna-clone color-change">
                  <div class=color-change>Chapter: <span>Index</span><span></span></div>
               </div>
            </div>
         </div>
         <div class=dna-clone>
            <div>Author: <span>Lee</span></div>
            <div>
            </div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test07 = {
   run: function() {
      console.log('Test Case: #07');
      var book1 = { author: { name: 'Ed' } };
      var book2 = { author: { name: 'Jan' } };
      var book3 = { author: { name: 'Lee' } };
      dna.clone('t07-book', book1);
      var clone = dna.clone('t07-book', book2);
      var chapters = [{ header: 'Preface' }, { header: 'Index' }]
      dna.clone('t07-book-chapter', chapters, { container: clone }).addClass('color-change');
      dna.clone('t07-book', book3);
      }
   };
$(test07.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #08</h3>
   <p>Add 2 items and mutate</p>
   <fieldset>
      <legend>Actual</legend>
      <p>
         Authors (1):
         <span id=t08-book-authors1 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <p>
         Authors (2):
         <span id=t08-book-authors2 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <p>
         Authors (3):
         <span id=t08-book-authors3 class=dna-template data-separator=", " data-last-separator=" and ">
            <span>~~[value]~~</span>
         </span>
      </p>
      <div class=book-list>
         <div id=t08-book class=dna-template>
            <div>Title:   <span>~~title~~</span></div>
            <div>Authors:
               <span data-array=~~authors~~>
                  *<span data-setup=test08.init>~~[value]~~</span>
               </span>
            </div>
            <div>Score:   <span>~~score~~</span></div>
            <div>On Sale: <span>~~sale~~</span></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <p>
         Authors (1):
         <span class=dna-clone>Jan</span>
      </p>
      <p>
         Authors (2):
         <span class=dna-clone>Jan and </span>
         <span class=dna-clone>Bo</span>
      </p>
      <p>
         Authors (3):
         <span class=dna-clone>Jan, </span>
         <span class=dna-clone>Bo and </span>
         <span class=dna-clone>Ed</span>
      </p>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:   <span>The New DOM</span></div>
            <div>Authors: <span> *<span class=color-change>Jan II</span></span><span>
               *<span class=color-change>Bo</span></span>
            </div>
            <div>Score:   <span>81</span></div>
            <div>On Sale: <span>true</span></div>
         </div>
         <div class="dna-clone border-change">
            <div>Title:   <span>Howdy HTML5</span></div>
            <div>Authors: <span> *<span class=color-change>Ed II</span></span>
            </div>
            <div>Score:   <span>97</span></div>
            <div>On Sale: <span>false</span></div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test08 = {
   init: function(elem) {
      elem.addClass('color-change');
      },
   run: function() {
      console.log('Test Case: #08');
      dna.clone('t08-book-authors1', ['Jan']);
      dna.clone('t08-book-authors2', ['Jan', 'Bo']);
      dna.clone('t08-book-authors3', ['Jan', 'Bo', 'Ed']);
      var book1 = { title: 'The DOM',     authors: ['Jan'],          score: 77, sale: false };
      var book2 = { title: 'The New DOM', authors: ['Jan II', 'Bo'], score: 81, sale: true };
      var book3 = { title: 'Howdy HTML5', authors: ['Ed'],           score: 92, sale: false };
      //clone #1
      var clone1 = dna.clone('t08-book', book1);
      var modelOk = dna.getModel(clone1).title === book1.title;  //test initial model
      dna.mutate(clone1, book2);
      //clone #2
      var clone2 = dna.clone('t08-book', book3);
      dna.getModel(clone2).authors = ['Ed II'];
      dna.getModel(clone2).score = 97;
      dna.mutateAll('t08-book');
      modelOk = modelOk && dna.getModel('t08-book')[1].score === 97;  //test mutated model
      clone2.addClass(modelOk ? 'border-change' : 'color-change');
      }
   };
$(test08.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #09</h3>
   <p>
      Add 2 items
      (<span><span id=rest-link class=dna-template>
         <a href=~~[value]~~ onclick="this.target='_blank';">book <span>~~[count]~~</span></a>
         <span class=dna-separator>and</span>
      </span></span>)
      loaded from REST call
   </p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t09-book class=dna-template>
            <div>Title:  <span>~~title~~</span></div>
            <div>Author: <span>~~author~~</span></div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>Go JavaScript</span></div>
            <div>Author: <span>Jake</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Styling CSS3</span></div>
            <div>Author: <span>Abby</span></div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test09 = {
   run: function() {
      console.log('Test Case: #09');
      dna.clone('rest-link', ['http://dnajs.org/rest/book/1', 'http://dnajs.org/rest/book/2']);
      dna.load('t09-book', 'http://dnajs.org/rest/book/1');
      dna.load('t09-book', 'http://dnajs.org/rest/book/2');
      dna.load('t09-book', 'http://dnajs.org/rest/book/7');  //test call to missing resource
      }
   };
$(test09.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #10</h3>
   <p>Add 1 item and apply callback function</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t10-book class=dna-template>
            <div>~~title~~</div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone
            style="height: 60px; color: white; background-image: url(http://dnajs.org/graphics/dnajs-logo.png); background-size: 80px;">
            <div>Background</div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test10 = {
   run: function() {
      console.log('Test Case: #10');
      var applyBackgnd = function(elem, data) {
         elem.css({ height: '60px', color: 'white',
            'background-image': data.image, 'background-size': '80px' });
         };
      var book = { title: 'Background', image: 'url(http://dnajs.org/graphics/dnajs-logo.png)' };
      var options = { fade: true, callback: applyBackgnd };
      dna.clone('t10-book', book, options);
      }
   };
$(test10.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #11</h3>
   <p>Add 2 items with missing fields</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t11-book class=dna-template>
            <div>Title:
               <span data-require=~~title~~>~~title~~</span>
               <span data-missing=~~title~~><i>[Gone with the Wind]</i></span>
            </div>
            <div data-require=~~author~~>Author: <span>~~author~~</span></div>
            <div data-missing=~~author~~><i>[no author]</i></div>
            <div data-truthy=~~available~~>Available</div>
            <div data-falsey=~~available~~>Out of stock</div>
            <div data-truthy=~~onSale~~>ON SALE!</div>
            <div data-falsey=~~onSale~~>Regular price</div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:
               <span><i>[Gone with the Wind]</i></span>
            </div>
            <div>Author: <span>Jan</span></div>
            <div>Available</div>
            <div>ON SALE!</div>
         </div>
         <div class=dna-clone>
            <div>Title:
               <span>Howdy HTML5</span>
            </div>
            <div><i>[no author]</i></div>
            <div>Out of stock</div>
            <div>Regular price</div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test11 = {
   run: function() {
      console.log('Test Case: #11');
      var book1 = { author: 'Jan',        available: 1, onSale: 'true' };
      var book2 = { title: 'Howdy HTML5', available: 0, onSale: [] };
      dna.clone('t11-book', book1);
      dna.clone('t11-book', book2);
      }
   };
$(test11.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #12</h3>
   <p>Array field (sub-template)</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t12-book class=dna-template>
            <div>
               Title: <span>~~title~~</span>
            </div>
            Authors:
            <span>
               <span data-array=~~authors~~ data-author=~~[value]~~>
                  (<span>~~[count]~~</span>)
                  <span>~~[value]~~</span>
               </span>
            </span>
            <div class=color-change data-array=~~chapters~~>
               <span data-class=~~type~~ data-type=~~type~~>~~type~~</span>:
               <span id=~~type~~>~~header~~</span>
            </div>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            <div>Title:  <span>The DOM</span></div>
            Authors:
            <span>
               <span class=dna-clone data-author="Bo I"> (1) <span>Bo I</span> </span>
               <span class=dna-clone data-author="Bo II"> (2) <span>Bo II</span> </span>
            </span>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Howdy HTML5</span></div>
            Authors:
            <span>
               <span class=dna-clone> (1) <span>Ed</span> </span>
               <span class="dna-clone color-change2"> (2) <span>Jake</span> </span>
               <span class=dna-clone> (3) <span>Abby</span> </span>
            </span>
            <div class="dna-clone color-change"><span data-type=front>front</span>:
            <span id=front-expected>Preface</span></div>
            <div class="dna-clone color-change"><span data-type=back>back</span>:
            <span id=back-expected>Index</span></div>
         </div>
         <div class=dna-clone>
            <div>Title:  <span>Styling CSS3</span></div>
            Authors:
            <span>
            </span>
         </div>
         <div class="dna-clone border-change">
            <div>Title:  <span>Howdy HTML5</span></div>
            Authors:
            <span>
               <span class=dna-clone> (1) <span>Ed</span> </span>
               <span class="dna-clone color-change2"> (2) <span>Jake</span> </span>
               <span class=dna-clone> (3) <span>Abby</span> </span>
            </span>
            <div class="dna-clone color-change"><span data-type=front>front</span>:
            <span id=front-expected>Preface</span></div>
            <div class="dna-clone color-change"><span data-type=back>back</span>:
            <span id=back-expected>Index</span></div>
            <div class="dna-clone color-change"><span data-type=back>back</span>:
            <span id=back-expected>Bio</span></div>
            <div class="dna-clone color-change"><span data-type=back>back</span>:
            <span id=back-expected>Bio 3</span></div>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test12 = {
   run: function() {
      console.log('Test Case: #12');
      var chapters = [
         { header: 'Preface', type: 'front' },
         { header: 'Index',   type: 'back' }
         ];
      var moreChapters = [
         { header: 'Bio 2', type: 'back' },  //TODO: Fix duplicate ids (5 chapters end up with "id=back")
         { header: 'Bio 3', type: 'back' }
         ];
      var authors = ['Ed', 'Jake', 'Abby'];
      var book1 = { title: 'The DOM' };
      var book2 = { title: 'Howdy HTML5',  authors: authors, chapters: chapters };
      var book3 = { title: 'Styling CSS3', authors: [],      chapters: [] };
      dna.clone('t12-book', [book1, book2, book3, book1]);
      dna.cloneSubTemplate(dna.getClones('t12-book').first(), 'authors', 'Bo I');
      dna.cloneSubTemplate(dna.getClones('t12-book').first(), 'authors', 'Bo II');
      var clone = dna.mutate($('.t12-book').last(), book2);
      dna.cloneSubTemplate(clone, 'chapters', { header: 'Bio', type: 'back' });
      dna.cloneSubTemplate(clone, 'chapters', moreChapters);
      var elem = $('.t12-book').find(':contains(Bio 2)');
      dna.destroy(elem, { main: false });
      clone.toggleClass('border-change', dna.getModel(clone).chapters.length === 4);
      $('.t12-book').find('[data-author=Jake]').addClass('color-change2');
      }
   };
$(test12.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #13</h3>
   <p>Security</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t13-book class=dna-template>
            Title: <span>~~[value]~~</span>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            Title: <span>&lt;script&gt;alert(1);&lt;/script&gt;</span>
         </div>
         <div class=dna-clone>
            Title: <span>&lt;script&gt;alert(2);&lt;/script&gt;</span>
         </div>
         <div class=dna-clone>
            Title: <span>3</span>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test13 = {
   run: function() {
      console.log('Test Case: #13');
      dna.clone('t13-book', '<script>alert(1);<\/script>');
      dna.clone('t13-book', '<script>alert(2);<\/script>', { html: false });
      dna.clone('t13-book', '<script>$(".t13-book").last().find("span").text(3);<\/script>',
         { html: true });
      }
   };
$(test13.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #14</h3>
   <p>Simple array</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t14-book class=dna-template>
            Book #<span>~~[count]~~</span>: <span>~~[value]~~</span>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            Book #<span>1</span>: <span>The DOM</span>
         </div>
         <div class=dna-clone>
            Book #<span>2</span>: <span>Howdy HTML5</span>
         </div>
         <div class=dna-clone>
            Book #<span>3</span>: <span>Styling CSS3</span>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test14 = {
   run: function() {
      console.log('Test Case: #14');
      var books = ['The DOM', 'Howdy HTML5', 'Styling CSS3'];
      dna.clone('t14-book', books);
      }
   };
$(test14.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #15</h3>
   <p>Events</p>
   <fieldset>
      <legend>Actual</legend>
      <p class=dna-setup data-setup=dna.ui.deleteElem>DELETE ME!</p>
      <section data-setup=dna.ui.deleteElem class=surrounded></section>
      <hr>
      <div class=book-list>
         <div id=t15-book class=dna-template data-setup=test15.init>
            <div class=surrounded>
               <span class=count>~~[count]~~</span>: <span>~~[value]~~</span>
            </div>
            <button class=1 data-click=dna.bye>Bye 1</button>
            <button class=2>Bye 2</button>
            <button class=3 data-click=test15.bye>Bye 3</button>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <section class=border-change style="color: white; padding: 10px;">
         <hr class=border-change2>
         <hr class=border-change2 style="color: white; padding: 10px;">
      </section>
      <hr>
      <div class=book-list>
         <div class="dna-clone color-change border-change2">
            <div class=border-change style="color: white; padding: 10px;">
               <span class=count>3</span>: <span>Howdy HTML5</span>
            </div>
            <button>Bye 1</button>
            <button>Bye 2</button>
            <button>Bye 3</button>
         </div>
         <div class="dna-clone color-change border-change2">
            <div class=border-change style="color: white; padding: 10px;">
               <span>5</span>: <span>Styling CSS3</span>
            </div>
            <button>Bye 1</button>
            <button>Bye 2</button>
            <button>Bye 3</button>
         </div>
         <hr><hr><hr><hr><hr><hr><hr><hr><hr><hr>
      </div>
   </fieldset>
</div>
<script>
var test15 = {
   init: function(elem) {
      elem.addClass('color-change');
      },
   surround: function(elem) {
      elem.addClass('border-change');
      function addHr() { $('.test-case').eq(15-1).find('fieldset').first().append('<hr>'); }
      elem.each(addHr);  //exactly 9 times (1 <section> + 8 clones + 1 <hr>)
      },
   surround2: function(elem) {
      elem.addClass('border-change2');
      },
   bye: function(elem, e) {
      if (e.type === 'click')
         dna.bye(elem);
      },
   run: function() {
      console.log('Test Case: #15');
      dna.registerInitializer('test15.surround', { selector: '.surrounded' });
      dna.registerInitializer('css', { selector: '.surrounded', params: { color: 'white' } });
      dna.registerInitializer('css', { selector: '.surrounded', params: ['padding', '10px'] });
      dna.registerInitializer(test15.surround2);  //apply to each clone
      var titles = ['NUKE', 'NUKE', 'Howdy HTML5', 'NUKE', 'Styling CSS3', 'NUKE', 'NUKE', 'NUKE'];
      dna.clone('t15-book', titles);
      $('.t15-book button.2').click(dna.bye);  //add handler
      function getClone(count) {
         return $('.t15-book .count:contains(' + count + ')').closest('.dna-clone');
         }
      getClone(1).find('button.1').click();                  //nuke 1st (bye w/data-click)
      getClone(2).find('button.2').click();                  //nuke 2nd (bye w/event handler)
      getClone(8).find('button.3').click();                  //nuke 8th (remove w/dna click callback)
      dna.bye(getClone(4));                                  //nuke 4th (bye w/jQuery elem)
      dna.getClone(getClone(7).find('span:last')).remove();  //nuke 7th (remove w/sub-node)
      getClone(6).each(dna.bye);                             //nuke 6th (bye w/jQuery loop)
      var box = $('.t15-book').closest('fieldset').find('section');
      var foreigners = $('<hr><hr data-setup=fadeOut><hr class=surrounded>').appendTo(box);
      dna.events.runInitializers(foreigners);
      dna.clearInitializers();
      }
   };
$(test15.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<div class=test-case>
   <h3>Test Case: #16</h3>
   <p>Input tag properties (minimized attributes)</p>
   <fieldset>
      <legend>Actual</legend>
      <div class=book-list>
         <div id=t16-book class=dna-template>
            Title: <input value=~~title~~>
            <div>
               <label data-array=~~options~~>
                  <input type=checkbox value=~~code~~ data-prop-checked=~~set~~>
                  <span>~~name~~</span>
               </label>
            </div>
            Cover:
            <div>
               <label data-array=~~cover~~ data-input-name=cover> <!-- TBD grouping feature -->
                  <input type=radio value=~~code~~ name=cover
                     data-prop-disabled=~~reject~~ data-prop-checked=~~set~~>
                  <span>~~name~~</span>
               </label>
            </div>
            Purpose:
            <select>
               <option data-array=~~purposes~~ value=~~code~~
                  data-prop-selected=~~set~~>~~name~~</option>
            </select>
         </div>
      </div>
   </fieldset>
   <fieldset>
      <legend>Expected</legend>
      <div class=book-list>
         <div class=dna-clone>
            Title: <input value="The DOM!" class=border-change>
            <div>
               <label>
                  <input type=checkbox value=fast checked>
                  <span>Overnight</span>
               </label>
               <label class=border-change>
                  <input type=checkbox value=social checked>
                  <span>Social share</span>
               </label>
               <label>
                  <input type=checkbox value=gift>
                  <span>Gift</span>
               </label>
            </div>
            Cover:
            <div>
               <label>
                  <input type=radio value=soft name=cover-expected>
                  <span>Paperback</span>
               </label>
               <label class=border-change>
                  <input type=radio value=hard name=cover-expected checked>
                  <span>Hardcover</span>
               </label>
               <label>
                  <input type=radio value=ebook name=cover-expected disabled>
                  <span>Digital</span>
               </label>
            </div>
            Purpose:
            <select class=border-change>
               <option value=work>Business</option>
               <option value=fun selected>Personal</option>
               <option value=edu>School</option>
            </select>
         </div>
      </div>
   </fieldset>
</div>
<script>
var test16 = {
   simulateUserInputText: function(elem) {
      elem.val('The DOM!').change();
      elem.addClass(dna.getModel(elem).title === 'The DOM!' ? 'border-change' : 'color-change');
      },
   simulateUserInputCheckbox: function(elem) {
      elem.click();  //check "Social Share" box
      elem.parent().addClass(dna.getModel(elem).options[1].set ? 'border-change' : 'color-change');
      },
   simulateUserInputRadioButton: function(elem) {
      if (elem.closest('div').find('input:checked').val() === 'soft')  //"Paperback" selected
         elem.click();  //select "Hardcover"
      elem.parent().addClass(dna.getModel(elem).cover[1].set === true ? 'border-change' : 'color-change');
      },
   simulateUserInputDropDown: function(elem) {
      if (elem.parent().val() === 'edu')  //"School" selected
         elem.parent().val('fun').change();  //select "Personal"
      var options = dna.getModel(elem).purposes;
      elem.parent().addClass(options[1].set === true && options[2].set === false ? 'border-change' : 'color-change');
      },
   run: function() {
      console.log('Test Case: #16');
      var options = [
         { code: 'fast',  name: 'Overnight',    set: true },
         { code: 'share', name: 'Social Share', set: false },
         { code: 'gift',  name: 'Gift',         set: false }
         ];
      var cover = [
         { code: 'soft',  name: 'Paperback', reject: 0, set: 1 },
         { code: 'hard',  name: 'Hardcover', reject: 0, set: 0 },
         { code: 'ebook', name: 'Digital',   reject: 1, set: 0 }
         ];
      var purposes = [
         { code: 'work', name: 'Business', set: 'F' },
         { code: 'fun',  name: 'Personal', set: 'F' },
         { code: 'edu',  name: 'School',   set: 'T' }
         ];
      var book = { title: 'The DOM', options: options, cover: cover, purposes: purposes };
      var clone = dna.clone('t16-book', book);
      test16.simulateUserInputText(clone.find('input:text'));
      test16.simulateUserInputCheckbox(clone.find('input[value=share]'));
      test16.simulateUserInputRadioButton(clone.find('input[value=hard]'));
      test16.simulateUserInputDropDown(clone.find('option[value=fun]'));
      }
   };
$(test16.run);
</script>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<script>$(testing.summary);</script>
</body>
</html>
